(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-277b0587"],{"176c":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{attrs:{"fill-height":"",fluid:"","grid-list-xl":""}},[i("FlashMessage"),i("v-layout",{attrs:{"justify-center":"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md8:""}},[i("material-card",{attrs:{color:"green",title:"Подпись нового документа",text:"Заполните указанные поля"}},[i("v-form",{on:{submit:e.formSubmit}},[i("v-container",{attrs:{"py-0":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("p",{staticClass:"text-info"},[e._v("Введите почтовые адреса подписантов через Enter. Допускается минимум 2 участника.")]),i("v-combobox",{attrs:{multiple:"",color:"purple",label:"Signer's emails",chips:"","deletable-chips":""},model:{value:e.emails,callback:function(t){e.emails=t},expression:"emails"}})],1),i("v-flex",{attrs:{xs12:""}},[i("p",{staticClass:"text-info"},[e._v("Выберите документ для подписи")]),i("input",{attrs:{type:"file",name:"document",id:"document"},on:{change:e.updateDocument}})]),i("v-flex",{attrs:{xs12:""}},[i("p",{staticClass:"text-info"},[e._v("Выберите файл ключей для подписи")]),i("input",{attrs:{type:"file",name:"keyfile",id:"keyfile"},on:{change:e.updateKeyFile}})]),i("v-flex",{attrs:{xs12:"","text-xs-right":""}},[i("v-btn",{staticClass:"mx-0 font-weight-light",attrs:{type:"submit",disabled:e.emails.length<2||0==e.validDocFile||0==e.validKeyFile,color:"success"}},[e._v("Подтвердить подпись")])],1)],1)],1)],1)],1)],1)],1)],1)},s=[],l=(i("28a5"),i("bc3a")),n=i.n(l),r=i("adc1"),o=i.n(r),c={name:"SignDoc",data:function(){return{privateKey:"",validDocFile:!1,validKeyFile:!1,publicKey:"",docFile:{},emails:[]}},created:function(){void 0!=this.$route.query.emails&&(this.emails=this.$route.query.emails.split(","))},methods:{updateDocument:function(e){e.target.files[0]?(this.docFile=e.target.files[0],this.validDocFile=!0):this.validDocFile=!1},updateKeyFile:function(e){var t=this;if(e.target.files[0]){var i=new FileReader,a=e.target.files[0];i.onload=function(e){t.privateKey=e.target.result.split("~12345~")[0],t.publicKey=e.target.result.split("~12345~")[1],void 0!=t.publicKey&&void 0!=t.privateKey||(t.validKeyFile=!1,t.flashMessage.error({title:"Что-то пошло не так",message:"Выбранный файл ключей имеет некорректную структуру. Попробуйте другой"}))},i.readAsText(a),this.validKeyFile=!0}else this.validKeyFile=!1},formSubmit:function(e){var t=this;e.preventDefault();var i=new FormData;i.set("publicKey",this.publicKey),i.set("privateKey",this.privateKey),i.set("signers",this.emails.join()),i.append("document",this.docFile),n.a.post("http://".concat(o.a.HOST,"/myroutes/signdoc"),i,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){e.data.hasOwnProperty("msg")?t.flashMessage.error({title:"Что-то пошло не так",message:e.data.msg}):(t.flashMessage.success({title:"Подпись документа завершена",message:"Уведомление о данном событии будет разослано всем участникам подписания"}),t.emails=[],document.getElementById("document").value="",document.getElementById("keyfile").value="")}).catch(function(e){console.log(e)})}}},u=c,d=i("2877"),p=Object(d["a"])(u,a,s,!1,null,null,null);t["default"]=p.exports},adc1:function(e,t){e.exports={HOST:"139.59.135.176:3000"}}}]);
//# sourceMappingURL=chunk-277b0587.8e507fc4.js.map